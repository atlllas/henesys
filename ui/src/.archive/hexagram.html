<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three.js Rectangle Click Flip</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
        .label {
            color: black;
            font-size: 24px;
            text-align: center;
        }
    </style>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <script>
        let clickCount = 0;

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0000);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.lookAt(0, 0.5, -2); // Look at the center of the rectangle
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        const planeWidth = 4.1;
        const planeHeight = 2.1;
        const geometry = new THREE.PlaneGeometry(planeWidth, planeHeight);

        const frontCanvas = document.createElement('canvas');
        frontCanvas.width = 1024;
        frontCanvas.height = 512;
        const frontContext = frontCanvas.getContext('2d');
        frontContext.font = '90px Arial';
        frontContext.fillStyle = 'white';

        const frontTexture = new THREE.CanvasTexture(frontCanvas);
        const frontMaterial = new THREE.MeshBasicMaterial({ map: frontTexture, side: THREE.FrontSide }); // Front side with the original texture
        
        function updateText() {
            frontContext.clearRect(0, 0, frontCanvas.width, frontCanvas.height); // Clear canvas before drawing new text
            let text = '';
            if (clickCount === 0) {
                text = 'Harmony';
            } else if (clickCount === 1) {
                text = 'Power';
            }
            const textWidth = frontContext.measureText(text).width; // Measure the width of the text
            frontContext.fillText(text, (frontCanvas.width - textWidth) / 2, 80);
            setTimeout(() => {
            frontTexture.needsUpdate = true;
        }, 200); // 500 milliseconds lag
        }

        const frontPlane = new THREE.Mesh(geometry, frontMaterial );
        frontPlane.position.set(0, 0, 0);
        scene.add(frontPlane);

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        let isFlipping = false;


        function onMouseClick(event) {
            updateText()
            clickCount = (clickCount + 1) % 2;

            // Log the click count to the console
            console.log('Click Count:', clickCount);

            const rotationTarget = clickCount === 1 ? Math.PI * 2 : 0;
            const animationDuration = 500; // Duration in milliseconds (1 second)
            isFlipping = true;

            updateText();


            const tween = new TWEEN.Tween(frontPlane.rotation)
                .to({ y: rotationTarget }, animationDuration)
                .easing(TWEEN.Easing.Quadratic.InOut)
                .onComplete(() => {
                    isFlipping = false;
                })
                .start();
        }

        // Add click event listener
        window.addEventListener('click', onMouseClick, false);
        camera.position.z = 3.5;

        function animate() {
            requestAnimationFrame(animate);

            TWEEN.update(); // Update tween animations

            renderer.render(scene, camera);
        }

        // Start the animation loop
        animate();
    </script>
</body>
</html>